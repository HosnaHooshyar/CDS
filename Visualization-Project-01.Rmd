---
title: "Visualization-project-01"
author: "Hosna H"
date: "12/13/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Acaddem Awards winners 2000-2017
## Dataset
[**Source of data**](https://www.kaggle.com/vipulgote4/oscars-nominated-movies-from-2000-to-2017).

This data-set contains all movies which were nominated for Academy Awards (Oscar) from 2000 to 2017 and their characteristics, including genre, domestic gross, and ratings.

The analyzing data will be done in multiple phases:

* Phase 1: Analyzing the Oscar award winners
+ Phase 2: Analyzing the domestic gross of Oscar-nominated movies in relation to other features
+ Phase 3: Analyzing the ratings each movie got from viewers and critics

To deal with data, the first step is calling the needed libraries (all of them are already installed in the console).
```{r warning=FALSE,message=FALSE}
library(tidyverse)
library(viridis)
library(colorspace)
library(RColorBrewer)
library(vcd)
library(hrbrthemes)
library(ggpubr)
```

The format of the data is textual, CSV (Comma Separated Values) to be exact. The data-set is named **oscar_data**. 
```{r warning=FALSE,message=FALSE}
oscar_data = read_csv ('BigML_Dataset_5f50a62c2fb31c516d000176.csv', na = c(""))
```

It is better to sort the data, base on the date:
```{r}
oscar_data <- arrange(oscar_data,year,release_date.month)
```

## Phase 1
In this phase the focus is on the movies that won at least one Oscar award and their features.

### Phase 1- Preprocessing
Since most data frames are not tidy or clean, it is important to study the chosen data in order to sort it, deal with missing data, remove unneeded information and etc. **oscar_data** contains 119 columns and 1183 rows, and considering the goal of this phase some of them may be unnecessary. We start by looking at the columns' names. 
```{r}
names(oscar_data)
```

As mentioned some of these columns,i.e. the columns containing information about the nomination or other awards, has nothing to do with our goal and need to be removed. The data-set will be named **oscar_data_1** after removing these columns. (The original data-set which is named **oscar_data** will remain untouched so it is usable for different phases and different purposes)

```{r}
oscar_data_1 <- oscar_data[, -c(36:116)] %>%
  select(-synopsis,
    -movie_id,
    -release_date,
    -popularity,
    -awards_nominations,
    -Oscar_Best_Picture_nominated,
    -Oscar_Best_Director_nominated,
    -Oscar_Best_Actor_nominated,
    -Oscar_Best_Actress_nominated,
    -Oscar_Best_Supporting_Actor_nominated,
    -Oscar_Best_Supporting_Actress_nominated,
    -Oscar_Best_AdaScreen_nominated,
    -Oscar_Best_OriScreen_nominated,
    -Oscar_nominated,
    -Oscar_nominated_categories,
    -awards_wins)
```
Since the only award in **oscar_data_1** is Oscar awards and only winners remained, some of the columns' names can be shortened.
```{r}
oscar_data_1 <- rename (oscar_data_1,
                        Picture = Oscar_Best_Picture_won,
                        Director = Oscar_Best_Director_won,
                        Actor = Oscar_Best_Actor_won,
                        Actress = Oscar_Best_Actress_won,
                        S_Actor = Oscar_Best_Supporting_Actor_won,
                        S_Actress = Oscar_Best_Supporting_Actress_won,
                        AdaScreen = Oscar_Best_AdaScreen_won,
                        OriScreen = Oscar_Best_OriScreen_won)
```

Also, all the movies that did not win an Oscar award should not be in this phase's data:
```{r}
oscar_data_1 <- filter(oscar_data_1,
                       (Picture == "Yes") |
                         (Director == "Yes") |
                         (Actor == "Yes") |
                         (Actress == "Yes") |
                         (S_Actor == "Yes") |
                         (S_Actress == "Yes") |
                         (AdaScreen == "Yes") |
                         (OriScreen == "Yes") )
```
A movie can be categorized in more than one genre. In this data-set, all information regarding genres are collected in one column which should be separated into multiple columns for two reasons:

* The tidiness of data-set
+ The importance of the first genre over the others

```{r warning=FALSE,message=FALSE}
oscar_data_1 <- separate(oscar_data_1, genre,
                         into = c("genre_1","genre_2","genre_3"))
```

Not all movies have three genres, as a result, some of the values in genre_2 and genre_3 columns are missing. R filled these missing values with **NA**. The **NA** values will be replaced by **No other genre**
```{r}
oscar_data_1 <- replace_na(oscar_data_1, list(genre_2 = "No other genre", genre_3 = "No other genre"))
```

Another column names **Award_category** will be added. The purpose of this feature is to summarize the information of the Oscar Awards' categories.
```{r}
oscar_data_1 <- pivot_longer(oscar_data_1,
             `Picture`:`OriScreen`,
             names_to = "Award_category",
             values_to = "Result") %>%
  filter(Result == "Yes") %>%
  rename(Award = Award_category) %>%
  select(-Result)
```

Another aspect that can be analyzed is looking at previous wins of this data-set's winners. Had they won any Oscar award before the 2000-2017 ceremonies? To answer this question another set of data was gathered from IMDb and Wikipedia websites. This new data-set, named **previous_win** expresses if the winner already had an Oscar award or not.
```{r warning=FALSE,message=FALSE}
previous_win <- read_csv ('previous_awards.csv')
previous_win
```

```{r}
#Adding a column to oscar_data_1 named Pre_award
oscar_data_1 <- cbind(oscar_data_1, Pre_award = previous_win$Pre_award)
```

### Phase 1- Visualization
To summarize what happened to the data up until now: The data, which is called **oscar_data_1**, only contains the movies that won an Oscar award from 2000 to 2017 in one or more of these eight categories:

* Best picture
+ Best director
+ Best actor
+ Best actress
+ Best supporting actor
+ Best supporting actress
+ Best adapted screenplay
+ Best original screenplay 

```{r}
oscar_data_1 %>%
  group_by(genre_1) %>%
  count() %>%
  ggplot(aes(x=reorder(genre_1,-n),y=n))+
  geom_col(fill = "white") +
  labs(x = "Genre", y = "Number of Oscar awards",
    title = "Plot #1.01",
    caption = "The first genre of movies are considered in this plot") +
  geom_text(aes(x = reorder(genre_1,-n), y=n + 1.8, label = n),color = "white") +
  theme_dark()
```

It is obvious that drama and biography movies were more successful in winning Oscar awards compared to other genres. The least successful genre is action genre which won only 3 awards in those 17 years.

To see the effect of second genre:
```{r}
oscar_data_1 %>%
  group_by(genre_1,genre_2) %>%
  count() %>%
  ggplot(aes(x = genre_1, y=n, fill=genre_2))+
  geom_col()+
  labs(x = "Genre", y = "Number of awards",
    title = "Plot #1.02") +
  guides(fill=guide_legend(title="Second_genre")) +
  geom_text(aes(x = genre_1, y=n, label = n),
    position = position_stack(vjust = 0.5),size = 3) +
  theme_dark()
```

It is not easy to read the colors of this plot because the colors are too similar to each other. So a list of more distinguishable colors will be defined and used.
```{r}
mycolors <- c("#28B463", "#D35400", "#DFFF00", "#C06C84", "#6495ED",
              "#10D300", "#DE3163", "#355C7D", "#784212", "#ff0000",
              "#8E44AD", "#F0F3F4", "#00FFFF", "#000080")
oscar_data_1 %>%
  group_by(genre_1, genre_2) %>%
  count() %>%
  ggplot(aes(x=genre_1, y=n, fill=genre_2))+
  geom_col()+
labs(x="Genre", y="Number of awards",
    title="Plot #1.03") +
guides(fill=guide_legend(title="Second_genre")) +
geom_text(aes(x=genre_1, y=n, label=n),
    position=position_stack(vjust=0.5),size=3) +
scale_fill_manual(values=mycolors) +
  theme_dark()
```

Looking at the graphs, it is obvious that drama movies were the most successful ones when it comes to winning an Oscar award. The second genre of 90% of adventure movies, 95% of biography movies, 85% of comedy movies and 100% of crime movies that won an Oscar was drama too. It is safe to say if someone wants to have a good chance of winning this award, they should make a drama movie.

What about each category of awards? Which genre did win the most awards in each category?
```{r}
mycolors_2 <- c("#ff0000", "#00FFFF","#FFC0CB", "#DFFF00", "#8E44AD", "#10D300")

oscar_data_1 %>%
  group_by(genre_1) %>%
  count(Award) %>%
  ggplot(aes(x=genre_1,y=n, fill=genre_1))+
  geom_col(color = "white")+
  labs(x = "Genre", y = "Number of awards",
    title = "Plot #1.04: Number of Oscar awards in each category") +
  theme_dark() +
  theme( axis.text.x=element_blank(),
         axis.ticks.x=element_blank(),
         axis.ticks.y=element_blank(),
         axis.text.y = element_blank(),
         axis.title.x=element_blank() ) +
  facet_wrap(vars(Award), nrow = 2) +
  guides(fill=guide_legend(title="First genre")) +
  geom_text(aes(x = genre_1, y=n, label = n),
    position = position_stack(vjust = 0.5),size = 3) +
  scale_fill_manual(values=mycolors_2)
  
```

Out of eight categories, drama movies won the most awards in four of them, best actress, best original screen, best supporting actor, and best-supporting actress. In two other categories, best actor and best-adapted screenplay, biography movies had a better chance.
The only category that was not influenced by genre as much as the others, is the best director. Although no director of action movies won an Oscar in those years (which is a surprise, action movies give directors a great opportunity to show their skills as a director) the numbers of awards in other genres are close.


Film Certificates are decided by the **Motion Picture Association film rating system**. In order to protect children from unsuitable and even harmful content in movies. **oscar_data_1** includes three certificate:

* **PG**: It May contain some material parents might not like for their young children.
+ **PG-13**: Some material may be inappropriate for children under 13.
+ **R**: Under 17 requires accompanying parent or adult guardian

[**Source**](https://en.wikipedia.org/wiki/Motion_Picture_Association_film_rating_system)

Is there any relation between the number of Oscar awards and movies' certificate?
```{r}
oscar_data_1 %>%
  group_by(certificate) %>%
  count(Award) %>%
  ggplot(aes(x=certificate,y=n, fill=certificate))+
  geom_col()+
  labs(x = "Certificate", y = "Number of awards",
    title = "Plot #1.05: Number of Oscar awards in each category") +
  theme_dark() +
  theme(axis.text.x=element_blank(),
        axis.ticks.x=element_blank(),
        axis.title.x=element_blank(),
        axis.ticks.y=element_blank(),
        axis.text.y = element_blank() ) +
  facet_wrap(vars(Award), nrow = 2) +
  guides(fill=guide_legend(title="certificat")) +
  geom_text(aes(x = certificate, y=n, label = n),
            position = position_stack(vjust = 0.5),size = 3) 
```

Women won more Oscar awards when they performed in PG-13 rated movies but in every other category, R rated movies were more successful.

After analyzing the data related to genres, we will look at the gross and its connection with other features. Gross refers to gross earnings
```{r}
num_awards <- oscar_data_1 %>%
  count(movie)
oscar_data_1 <- inner_join(oscar_data_1,num_awards,by="movie")
oscar_data_1_gross <- oscar_data_1[!duplicated(oscar_data_1$movie), ]
```

```{r}
oscar_data_1_gross <- rename (oscar_data_1_gross, awards_num = n)
```

It is important to know if there is a value missing from gross column or not.
```{r}
filter(oscar_data_1_gross, is.na(gross)) 
```

```{r}
#Converting gross to million dollars
oscar_data_1_gross <- mutate(oscar_data_1_gross, gross_million = gross/1e6) %>%
  drop_na()
```

```{r}
meta_min <- min(oscar_data_1_gross[,"metascore"])
meta_max <- max(oscar_data_1_gross[,"metascore"])
rate_min <- min(oscar_data_1_gross[,"rate"])
rate_max <- max(oscar_data_1_gross[,"rate"])
gross_min <- min(oscar_data_1_gross[,"gross_million"])
gross_max <- max(oscar_data_1_gross[,"gross_million"])

sprintf("Min of Metascore: %s", meta_min)
sprintf("Max of Metascore: %s", meta_max)
sprintf("Min of IMDb rating: %s", rate_min)
sprintf("Min of gross: %s", gross_min)
sprintf("Max of gross: %s", gross_max)
```

Minimum and maximum of gross, Metascore, and rate were obtained in order to change the limits of plots' axes if it helps with presentation.
```{r}
mycolors_3 <- c("#ff0000", "#00008b","#00FF00", "#DFFF00")


ggplot(data = oscar_data_1_gross,
       mapping = aes(x = metascore,y = gross_million, color=factor(awards_num))) +
  geom_point() +
  labs(x = "Metascore", y = "Gross(million $)",
       title = "Plot #1.06") +
  scale_color_manual(values=mycolors_3) +
  guides(color=guide_legend(title="Number of Oscars")) +
  scale_x_continuous(limits = c(50, 100),breaks = seq(50, 100, by = 10)) +
  scale_y_continuous (limits = c(0, 550),breaks = seq(0, 550, by = 50)) +
  theme_dark() +
  facet_wrap(vars(awards_num))
```

This plot shows most of the Oscar winning movies in the data-set only won one award and they rated from 53 to 100 by critics. It also shows that the highest grossing movie (with over 500 million dollars gross) won only one Oscar award.

```{r warning=FALSE,message=FALSE}
mycolors_3 <- c("#ff0000", "#00008b","#00FF00", "#DFFF00")
oscar_data_1_gross %>%
  group_by(year,awards_num) %>%
  summarise(mean_gross = mean(gross_million)) %>%

ggplot(mapping = aes(x = year, y = mean_gross,
                     color=factor(awards_num))) +
  geom_smooth(alpha = 0) +
    labs(x = "Year", y = "Mean of gross(million $)", title = "Plot #1.07") +
  scale_color_manual(values=mycolors_3) +
  guides(color=guide_legend(title="Number of Oscar awards")) +
  scale_x_continuous (limits = c(2000, 2017),breaks = seq(2000, 2017, by = 1)) +
  scale_y_continuous (limits = c(0, 500),breaks = seq(0, 500, by = 50)) +
  theme_dark() +
  theme(axis.text.x = element_text(angle=90, hjust=1)) 
```


```{r}
ggplot(data = oscar_data_1_gross,
       mapping = aes(y = gross_million, color=factor(awards_num)) ) +
  geom_boxplot() +
    labs(y="Gross(million $)", title = "Plot #1.08") +
  scale_color_viridis(discrete=T,option="E") +
  guides(color=guide_legend(title="Number of Oscar awards")) +
  scale_y_continuous (limits = c(0, 550),breaks = seq(0, 550, by = 50)) +
  scale_color_manual(values=mycolors_3) +
  theme_dark() +
      theme(axis.text.x=element_blank(),
          axis.ticks.x=element_blank(),
          axis.title.x=element_blank())
```

Looking at plot #1.08, we can see that the range of gross of movies with one Oscar goes from a financial failure to the most successful in 2000 to 2017. One-Oscar-movies' box also shows the lowest minimum and median and the highest number of outliers (an observation that is numerically distant from the rest of the data).

The highest maximum gross does not belong to four-Oscar-movies but the movies that won two awards. Although, it is necessary to consider the fact that according to plot #1.06, the number of movies that managed to win four Oscar awards is only 4.

```{r}
ggplot(data = oscar_data_1,
       mapping = aes(x = metascore,y = rate, color=factor(Pre_award))) +
  geom_point() +
  labs(x = "Metascore", y = "IMDb rating", 
       title = "Plot #1.09") +
  scale_color_manual(values=mycolors_3) +
  guides(color=guide_legend(title="Had they won an Oscar before this?")) +
  scale_x_continuous (limits = c(meta_min-1, 100),breaks = seq(50, 100, by = 10)) +
  scale_y_continuous (limits = c(6, 10),breaks = seq(6, 10, by = 1)) +
  theme_dark()
```

Plot #1.09 shows that the number of first winners is much higher that people who already had an Oscar award.
```{r fig1, fig.height = 3, fig.width = 5}
oscar_data_1 %>%
  group_by(Pre_award) %>%
  count(fill = "orange") %>%
  ggplot(aes(x = Pre_award, y = n)) +
  geom_col(fill = "white") +
  labs(x = "Had they won an Oscar before this?", title = "Plot #1.10") +
  theme_dark() +
   theme(axis.text.y=element_blank(),
          axis.ticks.y=element_blank(),
          axis.title.y=element_blank()) +
  geom_text(aes(x = Pre_award, y = n+6, label = n), color = "white")
```

85% of the winners won an Oscar award for the first time.

```{r}
oscar_data_1 %>%
  group_by(Pre_award, Award) %>%
  count(Pre_award) %>%
  ggplot(aes(x =Pre_award, y=n, fill=Pre_award))+
  geom_col()+
  labs(x = "Certificate", y = "Number of awards",
    title = "Plot #1.11") +
  theme_dark() +
  theme(axis.text.x=element_blank(),
        axis.ticks.x=element_blank(),
        axis.title.x=element_blank(),
        axis.ticks.y=element_blank(),
        axis.text.y = element_blank() ) +
  facet_wrap(vars(Award), nrow = 2) +
  guides(fill=guide_legend(title="Had they won an Oscar before?")) +
  geom_text(aes( y=n, label = n),
            position = position_stack(vjust = 0.5),size = 3) 
```

It is safe to say past awards do not push the jury to hand another Oscar but maybe the opposite is true. All the supporting actresses won the Oscar award for the first time.


## Phase 2
In this phase, the gross feature and its correlation with other features will be analyzed.

### Phase 2- Preprocessing
Unnecessary columns will be removed and the data-set for this phase is called  **oscar_data_2**.

```{r}
oscar_data_2 <- oscar_data[, -c(17:116)] %>%
  select(
    -movie_id,
    -synopsis,
    -release_date,
    -user_reviews,
    -critic_reviews,
    -popularity,
    -votes)
oscar_data_2
```

The **oscar_data_2** data-set has 12 columns and 1183 rows, describing all movies that were nominated for Oscar awards between 2000-2017. Just like phase 1, some changes must be done in order to have tidy data.

```{r}
oscar_data_2 %>%
filter(is.na(gross)) 
```

Since The grosses of 24 movies are missing from this data-set, another data-set called **missing_gross** will be uploaded to presents the information missing in **oscar_data_2**. In order to collect the **missing_gross**'s data, each movie's **Box Office Mojo** website page was visited.
```{r warning=FALSE,message=FALSE}
missing_gross = read_csv ('missing_gross.csv')
missing_gross
```

```{r}
#Joining two data-sets
oscar_data_2 <- full_join(oscar_data_2,missing_gross, by="movie") %>%
  mutate(gross = coalesce(gross.x,gross.y)) %>%
  select(-gross.x, -gross.y)
```

The domestic gross of some of these movies are not available on the internet (probably the reason is that these movies are not American), so there are still some missing values in the gross column.
```{r}
#Removing movies that their gross is missing
oscar_data_2 <- drop_na(oscar_data_2,gross)
```

The numbers of the gross column are converted to million dollars and placed in a new column called **gross_million**.
```{r}
oscar_data_2 <- mutate(oscar_data_2,gross_million = gross/1e6) %>%
  drop_na() %>%
  select(-gross)
```

```{r warning=FALSE,message=FALSE}
oscar_data_2 <- separate(oscar_data_2, genre,
                         into = c("genre_1","genre_2","genre_3"))

oscar_data_2 <- replace_na(oscar_data_2, list(genre_2 = "No othere genre", genre_3 = "No othere genre"))
```

In the **certificate** column, some movies have **Not Rated** and the others **Unrated** which are basically the same thing. So one will replace the other.
(This preprocessing step was added after trying to visualize the gross of movies in relation to the certificate.)
```{r}
oscar_data_2 <- transform(oscar_data_2,
                          certificate = ifelse(
                          certificate == "Not Rated","Unrated", certificate))
```

### Phase 2- Visualization

```{r warning=FALSE,message=FALSE}

mycolors <- c("#ff0000", "#D35400", "#DFFF00", "#C06C84", "#6495ED", "#10D300",
              "#000000", "#355C7D", "#784212", "#8E44AD", "#28B463", "#F0F3F4",
              "#000080")

ggplot(data = oscar_data_2,
       mapping = aes(x = metascore, y = gross_million, color=genre_1)) +
  geom_point() +
    labs(x = "Metascore", y="Gross(million $)", title = "Plot #2.01") +
  scale_x_continuous (limits = c(0, 100),breaks = seq(0, 100, by = 10)) +
  scale_y_continuous (limits = c(0, 550),breaks = seq(0, 550, by = 100)) +
  scale_color_manual(values=mycolors) +
  guides(color=guide_legend(title="First genre")) 
```
```{r warning=FALSE,message=FALSE}
#mycolors <- c("#ff0000", "#D35400", "#DFFF00", "#C06C84", "#6495ED", "#10D300",
 #             "#000000", "#355C7D", "#784212", "#8E44AD", "#28B463", "#F0F3F4",
  #            "#000080")

ggplot(data = oscar_data_2,
       mapping = aes(x = genre_1 , y = gross_million)) +
  geom_boxplot() +
    labs(x = "Genre", y="Gross(million $)", title = "Plot #2.02") +
  scale_y_continuous (limits = c(0, 550),breaks = seq(0, 550, by = 50)) +
  #scale_color_manual(values=mycolors) +
  guides(color=guide_legend(title="First genre")) +
  theme_bw() +
  theme(axis.text.x = element_text(angle=90, hjust=1),legend.position = "none")
  
```

Plot #2.02 shows that action, adventure, and animation movies were more successful in the financial areas than the others. Another piece of information offers by this plot is the dispersion of each genre's gross. While the profit of most genres is in a small range (when outliers are not considered), action, adventure, and animation movies could be very profitable or very close to a failure at Box Office. This plot also indicates that family, fantasy and romance genres had only one Oscar-nominated-movie during these years.


```{r}
oscar_data_2 %>%
  ggplot(aes(x = metascore, y = rate, fill = gross_million)) +
  geom_tile() +
      labs(x = "Metascore", y = "IMDb rating", title = "Plot #2.03") +
  scale_x_continuous (limits = c(0, 100),breaks = seq(0, 100, by = 10)) +
  scale_y_continuous (limits = c(1, 10),breaks = seq(1, 10, by = 1)) +
  scale_fill_continuous_divergingx(palette = 'RdYlGn', mid = 500)+
  theme_dark() +
  guides(fill=guide_colourbar(title="Gross(million$)"))
```

```{r}
oscar_data_2 %>%
  ggplot(aes(x = metascore, y = rate, fill = gross_million)) +
  geom_tile() +
      labs(x = "Metascore", y="IMDb rating",
    title = "Plot #2.04: Movies with high ratings") +
  scale_x_continuous (limits = c(80, 100),breaks = seq(80, 100, by = 2)) +
  scale_y_continuous (limits = c(8, 10),breaks = seq(8, 10, by = 0.5)) +
  scale_fill_continuous_divergingx(palette = 'RdYlGn', mid = 500)+
  theme_dark() +
  guides(fill=guide_colourbar(title="Gross(million$)"))
```
Plot #2.04 shows the movies that their ratings are considered high. The gross of these movies varies from less than 250 million $ to over 750. Two movies with the highest IMDb rating and highest Metascore could not reach 750 million dollars gross, something a movie with less rating achieved. It is not surprising because a movie's financial success depends on many variables, and what critics think is just one of them. A famous actor, a well-known director, a controversy are all can help to sell a movie.

```{r}
oscar_data_2 %>%
  group_by(genre_1) %>%
  summarise(sum_gross_genre = sum(gross_million)) %>%
  ggplot(aes(x = reorder(genre_1,-sum_gross_genre), y = sum_gross_genre) ) +
  geom_col(col = "red") +
  theme(axis.text.x = element_text(angle=90, hjust=1)) +
    labs(x = "First genre", y = "Sum of the gross (million $)",title = "Plot #2.05",
    caption = "The bars sorted in descending order") +
  scale_y_continuous(labels = scales::comma) 
```

Phase 1 proved that 62.5% of Oscar awards were won by drama and biography movies while action movies' share of awards was 2.25%. According to the last plot, although action movies could not shine on the Oscar stage, they managed to be the highest-grossing films among all Oscar nominated ones. But could it be the result of the number of action movies that were nominated?
```{r}
oscar_data_2 %>%
  group_by(genre_1) %>%
  summarise(mean_gross_genre = mean(gross_million)) %>%
  ggplot(aes(x = reorder(genre_1,-mean_gross_genre), y = mean_gross_genre) ) +
  geom_col(col = "red") +
  theme(axis.text.x = element_text(angle=90, hjust=1)) +
    labs(x = "First genre", y = "Mean of the gross (million$)",title = "Plot #2.06",
    caption = "The bars sorted in descending order") +
  scale_y_continuous(labels = scales::comma) 
```

As it can be seen, when the instead of the sum of gross, its mean is plotted, the highest gross genre would be family, which is odd, because to other genres, family movies are not very popular. If we take a look at movies in this genre:

```{r}
oscar_data_2 %>%
  filter(genre_1 == "Family")
```
The movie, **Beauty and the Beast** is made by Disney and this company categorizes all its movies as family movies while sometimes other genres are more suitable. In this case, animation and fantasy are better fits for the first genre.

```{r}
oscar_data_2 %>%
  group_by(year) %>%
  summarise(ymax = max(gross_million), ymin = min(gross_million),
            ymean = mean(gross_million)) %>%
  ggplot(
    aes(x = year, y = ymean, ymax = ymax, ymin = ymin,)) +
  geom_ribbon() +
  theme(axis.text.x = element_text(angle=90, hjust=1)) +
    labs(x = "Year", y = "Gross (million $)", title = "Plot #2.07") +
  scale_x_continuous (limits = c(2000, 2017),breaks = seq(2000, 2017, by = 1)) +
geom_line(color='red')

```
The maximum of Oscar-nominated-movies' gross fluctuated during the years but the mean of this number is almost the same. The sudden increases are related to the fact that every few years, some very profitable movies were nominated for Oscar awards.

Looking at plot #2.05, it is obvious that the gross of some genres is insignificant compared to others. That is why they are filtered in the next plot.

```{r}
oscar_data_2 %>%
  group_by(year,genre_1) %>%
  summarise(ymax = max(gross_million),
            ymin = min(gross_million),
            ymean = mean(gross_million)) %>%
  
  filter(   (genre_1 == "Action") |
            (genre_1 == "Adventure") |
            (genre_1 == "Animation") |
            (genre_1 == "Biography") |
            (genre_1 == "Comedy") |
            (genre_1 == "Drama") ) %>%
  
  ggplot(aes(x = year, y = ymean, ymax = ymax, ymin = ymin, fill = genre_1) ) +
  geom_ribbon() +
  theme(axis.text.x = element_text(angle=90, hjust=1),
        legend.position = "none") +
  labs(x = "Year", y = "Gross (million $)", title = "Plot #2.08") +
  geom_line(color='red') +
  facet_wrap(vars(genre_1), nrow = 3) +
  scale_x_continuous (limits = c(2000, 2017), breaks = seq(2000, 2017, by = 1))
```

It seems that sometimes the ribbon area is equal to zero, i.e. adventure genre in 2008. That is because, in that year, none of the nominated movies belonged to that genre. 

Comparing plot #2.07 and plot #2.08 shows that the action genre is the most effective genre on the gross of Oscar-nominated-movies in each year. which is not surprising, considering the fact that approximately 42% of the total gross belongs to this genre:
```{r}
oscar_data_2 %>%
      group_by(genre_1)%>%
  summarise(sum_gross_genre = sum(gross_million)) %>%
  mutate(sum_percentage = (sum_gross_genre/sum(sum_gross_genre))*100)
```

```{r}
#Gross per certificate 
oscar_data_2 %>%
  group_by(certificate) %>%
  summarise(sum_gross_certificate = sum(gross_million)) %>%
  ggplot(
    aes(x=certificate, y=sum_gross_certificate, fill=certificate) )+
  geom_col(colour = "black")+
  labs(x = "Certificate", y="Sum of gross (million $)",
    title = "Plot #2.09") +
  theme(axis.title.x=element_blank(),) +
  guides(fill=guide_legend(title="Certificat")) +
  scale_fill_brewer(palette = "Oranges") +
  scale_y_continuous(labels = scales::comma)
```

```{r}
#Gross per certificate 
oscar_data_2 %>%
  group_by(certificate) %>%
  summarise(mean_gross_certificate = mean(gross_million)) %>%
  ggplot(aes(x=certificate, y=mean_gross_certificate, fill=certificate) )+
  geom_col(colour = "black")+
  labs(x = "Certificate", y="Mean of gross (million $)",title = "Plot #2.10") +
  theme(axis.title.x=element_blank()) +
  guides(fill=guide_legend(title="Certificat")) +
  scale_fill_brewer(palette = "Blues")
```

Comparing plot #2.09 and #2.10 shows the reason that PG-13 movies had the highest gross, is the fact that the number of PG-13 nominated movies was more. When the effect of numbers is eliminated by using mean, we can see movies that are certificated as G, were more profitable.  

```{r warning=FALSE,message=FALSE}
oscar_data_2 %>%
  group_by(awards_wins) %>%
  summarise(mean_gross = mean(gross_million)) %>%
  ggplot( aes(x=awards_wins, y=mean_gross) )+
  geom_col(alpha = 0.8)+
  labs(x = "Number of awards", y = "Mean of gross (million$)", title = "Plot #2.11") +
  scale_x_continuous (limits = c(0, 50),breaks = seq(0, 50, by = 2)) +
  scale_color_manual(values=mycolors) +
  scale_y_continuous(labels = scales::comma,limits = c(0, 600),
                     breaks = seq(0, 600, by = 50))
```

Plot #2.04 proved that ratings cannot guarantee a movie's Box-office success and #2.11 tells us the same thing about the number of awards.

## Phase 3
In phase 1, some features of Oscar winner movies were analyzed and in phase 2, the gross of all Oscar-nominated movies was considered. The focus of phase 3 is the ratings that the movies got from viewers and critics which are called **rate** and **metascore** respectively.

### Phase 3- Preprocessing
Just like previous phases, phase 3 begins with altering the original data-set. The changed data-set is named **oscar_data_3**.

```{r}
#Removing columns that are not useful for this phase
oscar_data_3 <- oscar_data[, -c(17:35,37:39,41:119)] %>%
  select(
    -synopsis,
    -movie_id,
    -votes,
    -release_date,
    -user_reviews,
    -critic_reviews,
    -popularity)
oscar_data_3
```
**oscar_data_3** has two columns that indicated the number of Golden Globes and BAFTA awards each movie won. Another column is needed to specify the number of Oscar awards. To obtain this needed column, **oscar_data_1** will be used since in preprocessing of phase 1, a column for this very purpose was built and named **n**.

```{r}
oscar_won <- select(oscar_data_1,movie,n)
oscar_data_3 <- full_join(oscar_data_3,oscar_won, by="movie")
oscar_data_3 <- oscar_data_3[!duplicated(oscar_data_3), ]
```

The name of new column will change from **n** to **Oscar_won** and missing values will be replaced by 0 because in this case, a missing value means the movie did not win an Oscar award.
```{r}
oscar_data_3 <- oscar_data_3 %>%
  mutate(n = replace(n,is.na(n), 0)) %>%
  rename (Oscar_won = n)
```

```{r warning=FALSE,message=FALSE}
#Separating genre column into 3 columns: Genre 1,2 and 3
oscar_data_3 <- separate(oscar_data_3,genre,
                         into = c("genre_1","genre_2","genre_3"))

#Removing movies that their metascore value is missing
oscar_data_3 <- drop_na(oscar_data_3,metascore)
```

Among the awards mentioned in this data, there are three awards that are more famous and prestigious than the others: Oscar, Golden Globe, and BAFTA. A column named **main_amards** will be added to the data-set that shows the sum of these three awards for each movie
```{r}
oscar_data_3 <-  mutate(oscar_data_3,
                        main_awards = Golden_Globes_won + BAFTA_won + Oscar_won)
```

### Phase 3- Visualization
```{r}
ggplot(data = oscar_data_3,
       mapping = aes(x = metascore, y = rate, color=genre_1) ) +
  geom_point() +
    labs(x = "Metascore", y = "IMDb rating", title = "Plot #3.01") +
  scale_x_continuous (limits = c(0, 100),breaks = seq(0, 100, by = 10)) +
  scale_y_continuous (limits = c(1, 10),breaks = seq(1, 10, by = 1)) +
  guides(color=guide_legend(title="First genre")) 
```

To better understand the correlation between viewers' and critics' opinions:
```{r arning=FALSE,message=FALSE}
ggscatter(oscar_data_3, x = "metascore", y = "rate", 
          add = "reg.line", conf.int = TRUE,
          color = "gray",
          add.params = list(color = "black", fill = "lightgray"),
          cor.method = "pearson",
          xlab = "Metascore", ylab = "IMDb rating") +
  scale_x_continuous (limits = c(0, 100),breaks = seq(0, 100, by = 10)) +
  scale_y_continuous (limits = c(1, 10),breaks = seq(1, 10, by = 1)) +
  labs(title = "Plot #3.02")
```

```{r}
oscar_data_3 %>%
  group_by(genre_1) %>%
  summarise(mean_metascore = mean(metascore)) %>%
  ggplot(aes(x = reorder(genre_1,-mean_metascore),
             y = mean_metascore,fill = genre_1))+
  geom_col()+
  labs(x = "Genre", y = "Metascore", title = "Plot #3.03: Metascore ") +
    theme(axis.ticks.x=element_blank(),
          axis.title.x=element_blank(),
          legend.position = "none") +
  scale_y_continuous (limits = c(0, 100),breaks = seq(0, 100, by = 10)) +
  coord_flip() +
    geom_text(aes(x = reorder(genre_1,-mean_metascore), 
        y=mean_metascore - 1.8, label = floor(mean_metascore)) ) 

```

```{r}
oscar_data_3 %>%
  group_by(genre_1) %>%
  summarise(mean_rate = mean(rate)) %>%
  ggplot(aes(x = reorder(genre_1,-mean_rate), y = mean_rate, fill = genre_1))+
  geom_col()+
  labs(x = "Genre", y = "IMDb rating", title = "Plot #3.04: IMDb rating ") +
    theme(axis.ticks.x=element_blank(),
          axis.title.x=element_blank(),
          legend.position = "none") +
  scale_y_continuous (limits = c(0, 10),breaks = seq(0, 10, by = 1)) +
  coord_flip() +
      geom_text(aes(x = reorder(genre_1,-mean_rate), y=mean_rate - 0.2,
                    label = round(mean_rate, digits=1)) )
```

Surprisingly enough regular viewers enjoyed documentary movies more than other genres while the animation movies got the highest score from critics. Both groups showed the least amount of interest in sci (Sci-Fi) movies.

To see the ratings of the genres that had the most nominations from 2000 to 2017:
```{r}
#Finfing three genres with the most nominations
oscar_data_3 %>%
  group_by(genre_1) %>%
  ggplot(aes(x = genre_1 ))+
  geom_bar() +
  labs(x = "Genre", title = "Plot #3.05") +
  theme(axis.text.x = element_text(angle=90, hjust=1))
```

```{r}
mycolors <- c("#ff0000", "#DFFF00", "#00FF00")
oscar_data_3 %>%
  filter((genre_1 == "Action") |
           (genre_1 == "Comedy") |
           (genre_1 == "Drama") ) %>%
  ggplot(
    aes(x=year, y=metascore,
        color=genre_1)) +
stat_summary() +
  labs(x = "Year", y = "Metascore", title = "Plot #3.06") +
  theme_dark() +
  scale_color_manual(values = mycolors) +
  guides(color=guide_legend(title="First genre"))
```

```{r}
mycolors <- c("#ff0000", "#DFFF00", "#00FF00")
oscar_data_3 %>%
  filter((genre_1 == "Action") |
           (genre_1 == "Comedy") |
           (genre_1 == "Drama") ) %>%
  ggplot(
    aes(x = year, y = rate,
        color=genre_1)) +
stat_summary() +
  labs(x = "Year", y = "IMDb rating", title = "Plot #3.07") +
  theme_dark() +
  scale_color_manual(values = mycolors) +
  guides(color=guide_legend(title="First genre"))
```

Plot #3.07 displays that drama movies always got the best ratings from people but according to #3.06 there were times that critics preferred comedy over drama. Action and comedy movies switched second and third places from year to year.

```{r arning=FALSE,message=FALSE}
ggplot(data = oscar_data_3,
       mapping = aes(x = awards_wins, y = metascore)) +
  geom_point() +
    labs(x = "Number of awards", y="Metascore", title = "Plot #3.08") +
  scale_x_continuous (limits = c(0, 50),breaks = seq(0, 50, by = 5)) +
  scale_y_continuous (limits = c(0, 100),breaks = seq(0, 100, by = 10)) +
  guides(color=guide_legend(title="First genre")) +
  geom_smooth(color = "red")
```

```{r arning=FALSE,message=FALSE}
ggplot(data = oscar_data_3, mapping = aes(x = awards_wins, y = rate)) +
  geom_point() +
    labs(x = "Number of awards", y="IMDb ratings", title = "Plot #3.09") +
  scale_x_continuous (limits = c(0, 50),breaks = seq(0, 50, by = 5)) +
  scale_y_continuous (limits = c(0, 10),breaks = seq(0, 10, by = 1)) +
  guides(color=guide_legend(title="First genre")) +
  geom_smooth(color = "red")
```

Plot #3.08 shows all the movies that won over 30 awards in different ceremonies, had gotten high scores (over 80 out of 100) from critics. According to plot #3.09, the same thing is true regarding number of awards and IMDb ratings.

```{r}
oscar_data_3 %>%
  ggplot(aes(x = year, y = metascore, fill = factor(Oscar_won) )) +
  labs( x = "Year", y="Metascore", title = "Plot #3.10") +
  geom_tile() +
  theme_bw() +
  scale_x_continuous (limits = c(2000, 2017),breaks = seq(2000, 2017, by = 1)) +
  scale_y_continuous (limits = c(0, 100),breaks = seq(0, 100, by = 10)) +
  scale_fill_discrete_sequential(palette = "Terrain")+
  theme(axis.text.x = element_text(angle=90, hjust=1)) +
  guides(fill=guide_legend(title="Oscar"))

```

```{r}
oscar_data_3 %>%
  ggplot(aes(x = year, y = rate, fill = factor(Oscar_won) )) +
  labs( x = "Year", y="IMDb rating", title = "Plot #3.11") +
  geom_tile() +
  theme_bw() +
  scale_x_continuous (limits = c(2000, 2017),breaks = seq(2000, 2017, by = 1)) +
  scale_y_continuous (limits = c(1, 10),breaks = seq(1, 10, by = 1)) +
  scale_fill_discrete_sequential(palette = "Terrain")+
  theme(axis.text.x = element_text(angle=90, hjust=1)) +
  guides(fill=guide_legend(title="Oscar"))
```

In plots #3.10 and #3.11, the color white is chosen for movies that did not win any awards so the focus is on winners and their ratings. In both plots the ratings are not in the range that is considered high (8-10 for IMDb rating and 80-100 for Metascore).

```{r}
oscar_data_3 %>%
  ggplot(aes(x = metascore, y = rate, fill = factor(Oscar_won) )) +
  labs( x = "Metascore", y="IMDb rating", title = "Plot #3.12") +
  geom_tile() +
  theme_dark() +
  scale_x_continuous (limits = c(80, 100),breaks = seq(80, 100, by = 1)) +
  scale_y_continuous (limits = c(8, 10),breaks = seq(8, 10, by = 0.2)) +
  scale_fill_discrete_sequential(palette = "Terrain")+
  theme(axis.text.x = element_text(angle=90, hjust=1)) +
  guides(fill=guide_legend(title="Oscar awards"))
```

Plots #3.12 shows the number of Oscar awards does not have a direct relationship with ratings. Movies with high ratings fail to win even one award. 



# Conclusion
The data that was used for this project entailed every movie that was nominated for Oscar awards in one of these categories between 2000-2017:

* Best picture
+ Best director
+ Best actor
+ Best actress
+ Best supporting actor
+ Best supporting actress
+ Best adapted screenplay
+ Best original screenplay 

The analysis was done in three different phases. In **phase #1**, only movies that won at least one award were considered. After the preprocessing step was done, the number of rows reduced from 1183 to 136. During the visualization phase, it was discovered that the jury of Oscar was interested in drama movies more than any other genre. Around 32% of all awards belong to this genre. Even when the first genre of a winner movie was not drama, the second genre probably was. A similar result was observed from a plot that divided the winners into the eight mentioned categories. Biography is the second favorite genre of the Oscar jury.

Looking at the plots related to Oscar winners and certificate of movies, it can be seen that R movies were preferred over others in all categories except best actress. In the best supporting actress category, R moves have a higher number by one point, indicating that women have a better chance to win if they perform in PG-13 rated movies.

There is no apparent relation between the domestic gross and the number of Oscar awards. The number of movies that won just one award is more than the others that won 2,3 or 4 awards and their gross includes a bigger range.

The most interesting finding of this phase is the fact that unlike what is believed, Oscar-winner movies did not always get high scores from people or critics. They are some winners whose scores are considered low.

In **phase #2** the focus was on all the movies that were nominated for Oscar and their gross. Action, adventure, and animation were the genres with the highest gross. Three genres that were not very successful in winning Oscar awards, were the most profitable ones. Plot #2.06 shows the mean gross of every genre and genre family with one movie has the highest gross. But the fact is this movie is an animation, although its first genre identified as family.

**Phase #3** analyzed the nominated movies and their ratings from people (IMDb rating) and critics (Metascore). There is a linear correlation between these two. All the movies that won more than 30 awards have high scores from both groups of viewers. Although the same thing cannot be said about the Oscar-nominated movies. There are movies with very low ratings (less than 3 IMDb rating and less than 20 Metascore rating) that managed to be nominated for Oscar awards.